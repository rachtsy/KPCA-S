
| distributed init (rank 0): env://
Namespace(aa='rand-m9-mstd0.5-inc1', attack='hsja', batch_size=48, clip_grad=None, color_jitter=0.4, cooldown_epochs=10, cutmix=1.0, cutmix_minmax=None, data_path='/vinai/tannhm/imagenet/', data_set='IMNET', decay_epochs=30, decay_rate=0.1, device='cuda', dist_backend='nccl', dist_eval=False, dist_url='env://', distillation_alpha=0.5, distillation_tau=1.0, distillation_type='none', distributed=True, drop=0.0, drop_path=0.1, epochs=300, eps=10.0, eval='1', finetune='/home/ubuntu/Kpca/checkpoints/rpc/sym_baseline.pth', gpu=0, huber_a=0.2, inat_category='name', inc_path=None, input_size=224, job_name='sym_baseline_hsja', kernel_size=None, loss_type='huber', lr=0.0005, lr_noise=None, lr_noise_pct=0.67, lr_noise_std=1.0, min_lr=1e-05, mixup=0.8, mixup_mode='batch', mixup_prob=1.0, mixup_switch_prob=0.5, model='deit_tiny_patch16_224', model_ema=True, model_ema_decay=0.99996, model_ema_force_cpu=False, momentum=0.9, num_blocks=5, num_iter_kirwls=1, num_workers=10, opt='adamw', opt_betas=None, opt_eps=1e-08, outlier_fraction=0.1, output_dir='/home/ubuntu/Kpca/checkpoints/', patience_epochs=10, pin_mem=True, project_name='robust_attack', rank=0, recount=1, remode='pixel', repeated_aug=True, reprob=0.25, resplit=False, resume='', robust=False, sched='cosine', seed=0, smoothing=0.1, start_epoch=0, stride=None, teacher_model='regnety_160', teacher_path='', train_interpolation='bicubic', use_wandb='1', warmup_epochs=5, warmup_lr=1e-06, weight_decay=0.05, world_size=4)
Creating model: deit_tiny_patch16_224
number of params: 5272744
Traceback (most recent call last):
  File "/home/ubuntu/Kpca/Attack/main.py", line 550, in <module>
    main(args)
  File "/home/ubuntu/Kpca/Attack/main.py", line 433, in main
    test_stats = evaluate(data_loader_val, model, device, attack=args.attack, eps=args.eps)
  File "/home/ubuntu/Kpca/Attack/engine.py", line 109, in evaluate
    images = hop_skip_jump_attack(model, images, np.inf, num_iterations=10)
  File "/home/ubuntu/.conda/envs/torch1/lib/python3.8/site-packages/cleverhans/torch/attacks/hop_skip_jump_attack.py", line 211, in hop_skip_jump_attack
    pert = hsja(x_, None, None)
  File "/home/ubuntu/.conda/envs/torch1/lib/python3.8/site-packages/cleverhans/torch/attacks/hop_skip_jump_attack.py", line 108, in hsja
    perturbed, dist_post_update = binary_search_batch(
  File "/home/ubuntu/.conda/envs/torch1/lib/python3.8/site-packages/cleverhans/torch/attacks/hop_skip_jump_attack.py", line 304, in binary_search_batch
    decisions = decision_function(mid_images)
  File "/home/ubuntu/.conda/envs/torch1/lib/python3.8/site-packages/cleverhans/torch/attacks/hop_skip_jump_attack.py", line 93, in decision_function
    prob_i = model_fn(batch)
  File "/home/ubuntu/.conda/envs/torch1/lib/python3.8/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/ubuntu/.conda/envs/torch1/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 619, in forward
    output = self.module(*inputs[0], **kwargs[0])
  File "/home/ubuntu/.conda/envs/torch1/lib/python3.8/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/ubuntu/Kpca/Attack/softmax.py", line 264, in forward
    x = self.forward_features(x)
  File "/home/ubuntu/Kpca/Attack/softmax.py", line 255, in forward_features
    x = self.blocks(x)
  File "/home/ubuntu/.conda/envs/torch1/lib/python3.8/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/ubuntu/.conda/envs/torch1/lib/python3.8/site-packages/torch/nn/modules/container.py", line 117, in forward
    input = module(input)
  File "/home/ubuntu/.conda/envs/torch1/lib/python3.8/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/ubuntu/Kpca/Attack/softmax.py", line 129, in forward
    x = x + self.drop_path(self.mlp(self.norm2(x)))
  File "/home/ubuntu/.conda/envs/torch1/lib/python3.8/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/ubuntu/.conda/envs/torch1/lib/python3.8/site-packages/timm/layers/mlp.py", line 42, in forward
    x = self.fc1(x)
  File "/home/ubuntu/.conda/envs/torch1/lib/python3.8/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/ubuntu/.conda/envs/torch1/lib/python3.8/site-packages/torch/nn/modules/linear.py", line 93, in forward
    return F.linear(input, self.weight, self.bias)
  File "/home/ubuntu/.conda/envs/torch1/lib/python3.8/site-packages/torch/nn/functional.py", line 1692, in linear
    output = input.matmul(weight.t())
KeyboardInterrupt