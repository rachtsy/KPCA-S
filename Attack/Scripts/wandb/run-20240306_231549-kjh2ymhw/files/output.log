
| distributed init (rank 0): env://
Namespace(aa='rand-m9-mstd0.5-inc1', attack='cw', batch_size=48, clip_grad=None, color_jitter=0.4, cooldown_epochs=10, cutmix=1.0, cutmix_minmax=None, data_path='/vinai/tannhm/imagenet/', data_set='IMNET', decay_epochs=30, decay_rate=0.1, device='cuda', dist_backend='nccl', dist_eval=False, dist_url='env://', distillation_alpha=0.5, distillation_tau=1.0, distillation_type='none', distributed=True, drop=0.0, drop_path=0.1, epochs=300, eps=10.0, eval='1', finetune='/home/ubuntu/Kpca/checkpoints/rpc/4itperlayer1.pth', gpu=0, huber_a=0.2, inat_category='name', inc_path=None, input_size=224, job_name='sym_4itperlayer1_cw', kernel_size=None, loss_type='huber', lr=0.0005, lr_noise=None, lr_noise_pct=0.67, lr_noise_std=1.0, min_lr=1e-05, mixup=0.8, mixup_mode='batch', mixup_prob=1.0, mixup_switch_prob=0.5, model='deit_tiny_patch16_224', model_ema=True, model_ema_decay=0.99996, model_ema_force_cpu=False, momentum=0.9, num_blocks=5, num_iter_kirwls=1, num_workers=10, opt='adamw', opt_betas=None, opt_eps=1e-08, outlier_fraction=0.1, output_dir='/home/ubuntu/Kpca/checkpoints/', patience_epochs=10, pin_mem=True, project_name='robust_attack', rank=0, recount=1, remode='pixel', repeated_aug=True, reprob=0.25, resplit=False, resume='', robust=True, sched='cosine', seed=0, smoothing=0.1, start_epoch=0, stride=None, teacher_model='regnety_160', teacher_path='', train_interpolation='bicubic', use_wandb='1', warmup_epochs=5, warmup_lr=1e-06, weight_decay=0.05, world_size=4)
Creating model: deit_tiny_patch16_224
number of params: 5272744
Test:  [  0/695]  eta: 23:47:33  loss: 2.0952 (2.0952)  acc1: 76.3889 (76.3889)  acc5: 86.1111 (86.1111)  time: 123.2417  data: 28.9692  max mem: 7211
Test:  [ 10/695]  eta: 13:24:02  loss: 2.0952 (2.1914)  acc1: 63.8889 (63.2576)  acc5: 86.1111 (86.7424)  time: 70.4267  data: 2.6337  max mem: 7211
Test:  [ 20/695]  eta: 12:40:47  loss: 2.2960 (2.2634)  acc1: 62.5000 (64.4841)  acc5: 83.3333 (85.3175)  time: 64.8445  data: 0.0002  max mem: 7211
Test:  [ 30/695]  eta: 12:18:22  loss: 2.5472 (2.5040)  acc1: 54.1667 (58.2437)  acc5: 79.1667 (81.3620)  time: 64.5266  data: 0.0002  max mem: 7211
Test:  [ 40/695]  eta: 12:01:52  loss: 2.9616 (2.5994)  acc1: 48.6111 (56.1992)  acc5: 72.2222 (79.7425)  time: 64.5521  data: 0.0002  max mem: 7211
Test:  [ 50/695]  eta: 11:49:02  loss: 2.8834 (2.6335)  acc1: 48.6111 (55.0109)  acc5: 73.6111 (78.9216)  time: 64.9300  data: 0.0002  max mem: 7211
Test:  [ 60/695]  eta: 11:35:29  loss: 2.5224 (2.6006)  acc1: 56.9444 (55.8060)  acc5: 77.7778 (79.4627)  time: 64.8765  data: 0.0002  max mem: 7211
Test:  [ 70/695]  eta: 11:22:46  loss: 2.2043 (2.5222)  acc1: 63.8889 (58.0008)  acc5: 86.1111 (80.4969)  time: 64.4978  data: 0.0002  max mem: 7211
Test:  [ 80/695]  eta: 11:10:36  loss: 2.2700 (2.5588)  acc1: 66.6667 (57.6132)  acc5: 83.3333 (79.5096)  time: 64.5380  data: 0.0002  max mem: 7211
Test:  [ 90/695]  eta: 10:59:30  loss: 2.5678 (2.5787)  acc1: 52.7778 (57.2192)  acc5: 76.3889 (79.1209)  time: 64.9037  data: 0.0002  max mem: 7211
Test:  [100/695]  eta: 10:47:39  loss: 2.1005 (2.5150)  acc1: 66.6667 (58.4984)  acc5: 86.1111 (80.2255)  time: 64.8386  data: 0.0002  max mem: 7211
Test:  [110/695]  eta: 10:36:04  loss: 2.0524 (2.5245)  acc1: 66.6667 (58.3083)  acc5: 87.5000 (80.4555)  time: 64.4791  data: 0.0002  max mem: 7211
Test:  [120/695]  eta: 10:24:36  loss: 3.0128 (2.6021)  acc1: 40.2778 (56.4738)  acc5: 80.5556 (79.5340)  time: 64.5078  data: 0.0002  max mem: 7211
Test:  [130/695]  eta: 10:13:36  loss: 3.4394 (2.6624)  acc1: 36.1111 (55.2481)  acc5: 66.6667 (78.6684)  time: 64.7395  data: 0.0002  max mem: 7211
Test:  [140/695]  eta: 10:02:24  loss: 3.3589 (2.7068)  acc1: 40.2778 (54.3440)  acc5: 69.4444 (78.1422)  time: 64.8110  data: 0.0002  max mem: 7211
Test:  [150/695]  eta: 9:51:12  loss: 3.1535 (2.7380)  acc1: 41.6667 (53.6240)  acc5: 72.2222 (77.8514)  time: 64.6024  data: 0.0002  max mem: 7211
Test:  [160/695]  eta: 9:40:04  loss: 3.0787 (2.7675)  acc1: 40.2778 (52.8640)  acc5: 73.6111 (77.4758)  time: 64.5640  data: 0.0002  max mem: 7211
Test:  [170/695]  eta: 9:28:58  loss: 3.1210 (2.7903)  acc1: 41.6667 (52.2904)  acc5: 73.6111 (77.3067)  time: 64.5494  data: 0.0003  max mem: 7211
Test:  [180/695]  eta: 9:18:11  loss: 2.9779 (2.7852)  acc1: 43.0556 (52.3327)  acc5: 75.0000 (77.5629)  time: 64.8370  data: 0.0002  max mem: 7211
Test:  [190/695]  eta: 9:07:06  loss: 2.8016 (2.8021)  acc1: 47.2222 (51.9488)  acc5: 79.1667 (77.3415)  time: 64.8178  data: 0.0002  max mem: 7211
Test:  [200/695]  eta: 8:56:05  loss: 2.8900 (2.7960)  acc1: 44.4444 (51.9831)  acc5: 79.1667 (77.6258)  time: 64.5216  data: 0.0003  max mem: 7211
Test:  [210/695]  eta: 8:45:05  loss: 2.4820 (2.7797)  acc1: 56.9444 (52.5276)  acc5: 86.1111 (77.8897)  time: 64.5397  data: 0.0003  max mem: 7211
Test:  [220/695]  eta: 8:29:53  loss: 2.6067 (2.7769)  acc1: 55.5556 (52.4447)  acc5: 81.9444 (77.9098)  time: 58.6419  data: 0.0002  max mem: 7211
Test:  [230/695]  eta: 8:14:12  loss: 2.3194 (2.7405)  acc1: 59.7222 (53.1987)  acc5: 84.7222 (78.3790)  time: 51.1974  data: 0.0002  max mem: 7211
Test:  [240/695]  eta: 7:59:07  loss: 2.1982 (2.7458)  acc1: 61.1111 (53.2619)  acc5: 86.1111 (78.3080)  time: 49.6529  data: 0.0002  max mem: 7211
Test:  [250/695]  eta: 7:44:37  loss: 2.8083 (2.7478)  acc1: 50.0000 (53.2260)  acc5: 76.3889 (78.3256)  time: 49.6802  data: 0.0002  max mem: 7211
Test:  [260/695]  eta: 7:30:33  loss: 2.8415 (2.7528)  acc1: 51.3889 (53.2940)  acc5: 76.3889 (78.2195)  time: 49.6617  data: 0.0002  max mem: 7211
Test:  [270/695]  eta: 7:16:57  loss: 2.8415 (2.7521)  acc1: 51.3889 (53.2698)  acc5: 79.1667 (78.2800)  time: 49.6838  data: 0.0002  max mem: 7211
Test:  [280/695]  eta: 7:03:43  loss: 2.6950 (2.7511)  acc1: 51.3889 (53.4006)  acc5: 79.1667 (78.1633)  time: 49.7187  data: 0.0002  max mem: 7211
Test:  [290/695]  eta: 6:50:50  loss: 2.6950 (2.7616)  acc1: 47.2222 (53.1453)  acc5: 76.3889 (77.9448)  time: 49.7145  data: 0.0002  max mem: 7211
Test:  [300/695]  eta: 6:38:16  loss: 2.9763 (2.7694)  acc1: 44.4444 (53.0177)  acc5: 75.0000 (77.8101)  time: 49.7394  data: 0.0002  max mem: 7211
Test:  [310/695]  eta: 6:25:57  loss: 3.1585 (2.7842)  acc1: 40.2778 (52.6393)  acc5: 70.8333 (77.5277)  time: 49.7354  data: 0.0002  max mem: 7211
Test:  [320/695]  eta: 6:13:54  loss: 3.2800 (2.7992)  acc1: 40.2778 (52.2413)  acc5: 68.0556 (77.2542)  time: 49.7402  data: 0.0002  max mem: 7211
Test:  [330/695]  eta: 6:02:06  loss: 3.2846 (2.8117)  acc1: 41.6667 (52.0686)  acc5: 68.0556 (77.0141)  time: 49.7908  data: 0.0003  max mem: 7211
Test:  [340/695]  eta: 5:50:29  loss: 3.2846 (2.8245)  acc1: 44.4444 (51.8532)  acc5: 66.6667 (76.7392)  time: 49.8014  data: 0.0003  max mem: 7211
Test:  [350/695]  eta: 5:39:03  loss: 3.3608 (2.8452)  acc1: 37.5000 (51.4522)  acc5: 65.2778 (76.3018)  time: 49.7425  data: 0.0002  max mem: 7211
Test:  [360/695]  eta: 5:27:48  loss: 3.2853 (2.8523)  acc1: 37.5000 (51.2388)  acc5: 66.6667 (76.1927)  time: 49.7570  data: 0.0002  max mem: 7211
Test:  [370/695]  eta: 5:16:42  loss: 3.1650 (2.8574)  acc1: 43.0556 (51.1381)  acc5: 70.8333 (76.0819)  time: 49.7610  data: 0.0003  max mem: 7211
Test:  [380/695]  eta: 5:05:45  loss: 2.8447 (2.8582)  acc1: 48.6111 (51.1702)  acc5: 70.8333 (76.0462)  time: 49.7267  data: 0.0003  max mem: 7211
Test:  [390/695]  eta: 4:54:57  loss: 2.8201 (2.8578)  acc1: 52.7778 (51.2326)  acc5: 75.0000 (76.0514)  time: 49.7315  data: 0.0002  max mem: 7211
Test:  [400/695]  eta: 4:44:16  loss: 2.8069 (2.8551)  acc1: 55.5556 (51.4166)  acc5: 79.1667 (76.0737)  time: 49.7396  data: 0.0002  max mem: 7211
Test:  [410/695]  eta: 4:33:41  loss: 2.9872 (2.8683)  acc1: 48.6111 (51.1996)  acc5: 75.0000 (75.8786)  time: 49.7352  data: 0.0002  max mem: 7211
Test:  [420/695]  eta: 4:23:14  loss: 3.1660 (2.8753)  acc1: 45.8333 (51.0953)  acc5: 72.2222 (75.7192)  time: 49.7418  data: 0.0002  max mem: 7211
Test:  [430/695]  eta: 4:12:52  loss: 3.0549 (2.8771)  acc1: 48.6111 (51.1182)  acc5: 72.2222 (75.6445)  time: 49.7703  data: 0.0002  max mem: 7211
Test:  [440/695]  eta: 4:02:36  loss: 3.0549 (2.8876)  acc1: 41.6667 (50.9133)  acc5: 70.8333 (75.4472)  time: 49.7509  data: 0.0002  max mem: 7211
Test:  [450/695]  eta: 3:52:26  loss: 3.1195 (2.8858)  acc1: 43.0556 (50.8838)  acc5: 70.8333 (75.4681)  time: 49.7728  data: 0.0003  max mem: 7211
Test:  [460/695]  eta: 3:42:20  loss: 3.1195 (2.8963)  acc1: 44.4444 (50.5875)  acc5: 70.8333 (75.3163)  time: 49.7987  data: 0.0002  max mem: 7211
Test:  [470/695]  eta: 3:32:19  loss: 3.3493 (2.9045)  acc1: 31.9444 (50.4099)  acc5: 63.8889 (75.1268)  time: 49.7874  data: 0.0002  max mem: 7211
Test:  [480/695]  eta: 3:22:22  loss: 3.3099 (2.9099)  acc1: 43.0556 (50.3667)  acc5: 63.8889 (74.9596)  time: 49.7737  data: 0.0002  max mem: 7211
Test:  [490/695]  eta: 3:12:30  loss: 3.0284 (2.9137)  acc1: 48.6111 (50.3083)  acc5: 69.4444 (74.9265)  time: 49.7732  data: 0.0002  max mem: 7211
Test:  [500/695]  eta: 3:02:41  loss: 2.9076 (2.9135)  acc1: 48.6111 (50.3188)  acc5: 73.6111 (74.9168)  time: 49.7942  data: 0.0002  max mem: 7211
Test:  [510/695]  eta: 2:52:55  loss: 3.0357 (2.9178)  acc1: 44.4444 (50.2473)  acc5: 70.8333 (74.8125)  time: 49.7893  data: 0.0002  max mem: 7211
Test:  [520/695]  eta: 2:43:13  loss: 3.2895 (2.9242)  acc1: 41.6667 (50.1200)  acc5: 68.0556 (74.6028)  time: 49.7707  data: 0.0002  max mem: 7211
Test:  [530/695]  eta: 2:33:34  loss: 3.1328 (2.9262)  acc1: 45.8333 (50.1229)  acc5: 69.4444 (74.5658)  time: 49.7343  data: 0.0002  max mem: 7211
Test:  [540/695]  eta: 2:23:58  loss: 3.1328 (2.9329)  acc1: 45.8333 (50.0411)  acc5: 69.4444 (74.4172)  time: 49.7007  data: 0.0002  max mem: 7211
Test:  [550/695]  eta: 2:14:25  loss: 3.2573 (2.9332)  acc1: 41.6667 (50.0302)  acc5: 69.4444 (74.3572)  time: 49.6952  data: 0.0002  max mem: 7211
Test:  [560/695]  eta: 2:05:04  loss: 2.9280 (2.9323)  acc1: 44.4444 (50.0545)  acc5: 72.2222 (74.3241)  time: 51.6531  data: 0.0002  max mem: 7211
Test:  [570/695]  eta: 1:55:37  loss: 2.8680 (2.9339)  acc1: 52.7778 (49.9927)  acc5: 73.6111 (74.2873)  time: 52.1919  data: 0.0002  max mem: 7211
Test:  [580/695]  eta: 1:46:11  loss: 3.0892 (2.9421)  acc1: 47.2222 (49.8279)  acc5: 70.8333 (74.1107)  time: 50.2396  data: 0.0002  max mem: 7211
Test:  [590/695]  eta: 1:36:47  loss: 3.3706 (2.9515)  acc1: 36.1111 (49.5793)  acc5: 63.8889 (73.9143)  time: 49.7237  data: 0.0002  max mem: 7211
Test:  [600/695]  eta: 1:27:28  loss: 3.3846 (2.9568)  acc1: 36.1111 (49.4407)  acc5: 63.8889 (73.7983)  time: 50.5900  data: 0.0002  max mem: 7211
Test:  [610/695]  eta: 1:18:13  loss: 3.1086 (2.9571)  acc1: 47.2222 (49.4158)  acc5: 69.4444 (73.8043)  time: 52.4298  data: 0.0002  max mem: 7211
Test:  [620/695]  eta: 1:08:54  loss: 3.1959 (2.9636)  acc1: 48.6111 (49.3380)  acc5: 69.4444 (73.6536)  time: 51.5553  data: 0.0002  max mem: 7211
Test:  [630/695]  eta: 0:59:37  loss: 3.2133 (2.9646)  acc1: 47.2222 (49.2802)  acc5: 68.0556 (73.6419)  time: 49.6836  data: 0.0002  max mem: 7211
Test:  [640/695]  eta: 0:50:22  loss: 2.5819 (2.9575)  acc1: 54.1667 (49.3868)  acc5: 76.3889 (73.7455)  time: 49.6676  data: 0.0002  max mem: 7211
Test:  [650/695]  eta: 0:41:09  loss: 2.6910 (2.9567)  acc1: 52.7778 (49.3920)  acc5: 76.3889 (73.7669)  time: 49.6571  data: 0.0002  max mem: 7211
Test:  [660/695]  eta: 0:31:59  loss: 2.6401 (2.9463)  acc1: 52.7778 (49.5377)  acc5: 77.7778 (73.9116)  time: 51.0188  data: 0.0002  max mem: 7211
Test:  [670/695]  eta: 0:22:50  loss: 2.2521 (2.9408)  acc1: 59.7222 (49.6730)  acc5: 79.1667 (73.9775)  time: 52.5519  data: 0.0002  max mem: 7211
Test:  [680/695]  eta: 0:13:40  loss: 2.7403 (2.9386)  acc1: 50.0000 (49.6186)  acc5: 76.3889 (74.0231)  time: 51.2005  data: 0.0002  max mem: 7211
Test:  [690/695]  eta: 0:04:33  loss: 2.2051 (2.9228)  acc1: 56.9444 (49.9759)  acc5: 83.3333 (74.2242)  time: 49.6444  data: 0.0002  max mem: 7211
Test:  [694/695]  eta: 0:00:54  loss: 2.1700 (2.9228)  acc1: 62.5000 (50.0000)  acc5: 84.7222 (74.2440)  time: 49.0986  data: 0.0001  max mem: 7211
Test: Total time: 10:32:35 (54.6118 s / it)
Evaluating attack method cw with perturbation budget 10.0:
* Acc@1 50.000 Acc@5 74.244 loss 2.923
Accuracy of the network on the 50000 test images: 50.0%